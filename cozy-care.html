<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width,initial-scale=1"/>
<title>üêæ Cozy Care ‚Äî Dream Room</title>

<!-- Tailwind CDN -->
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com/css2?family=Pacifico&family=Inter:wght@300;400;600;700;800&display=swap" rel="stylesheet">

<style>
  :root{
    --accent1:#ff99cc; --accent2:#ff66b2;
    --deep:#2b1422; --muted:#7b2f5b;
  }
  html,body{height:100%; margin:0;}
  body{
    font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, Arial;
    background: linear-gradient(180deg,#ffe9f3 0%,#fff4fb 45%, #fffafc 100%);
    color:var(--deep);
    -webkit-font-smoothing:antialiased;
    -moz-osx-font-smoothing:grayscale;
    display:flex; justify-content:center; padding:20px;
  }

  /* page shell */
  .stage {
    width:100%;
    max-width:1100px;
    display:grid;
    grid-template-columns: 1fr;
    gap:18px;
  }
  @media(min-width:920px){
    .stage { grid-template-columns: 360px 1fr; align-items:start; }
  }

  /* left: cozy shelf / controls */
  .left {
    display:flex; flex-direction:column; gap:18px;
  }

  .panel {
    background: linear-gradient(180deg, rgba(255,255,255,0.98), rgba(255,250,253,0.98));
    border-radius: 18px;
    padding:14px;
    box-shadow: 0 16px 40px rgba(255,150,185,0.12);
    border:1px solid rgba(255,220,230,0.7);
  }

  header h1 { font-family: 'Pacifico', cursive; font-size:1.6rem; margin:0; color:var(--deep); text-align:center;}
  .sub { color:var(--muted); }

  /* Shelf/Book */
  .room-illustration { width:100%; height:auto; display:block; }

  .book {
    width:140px; height:100px; border-radius:10px;
    background: linear-gradient(180deg,#ffdfe9,#ffd1e3);
    box-shadow: 0 10px 22px rgba(255,150,185,0.12);
    border:1px solid rgba(255,200,220,0.9);
    position:relative; margin:auto; cursor:pointer;
    transform-origin: left center; transition: transform .5s cubic-bezier(.2,.9,.2,1);
  }
  .book.open { transform: rotateY(-18deg) translateX(-6px) scale(1.02); }
  .book::before{ content:''; position:absolute; left:8px; top:10px; width:6px; bottom:10px; background: linear-gradient(180deg,#fff0f6,#ffe6f0); border-radius:3px; }
  .book-label { position:absolute; right:10px; top:32px; font-weight:700; color:var(--deep); font-size:0.95rem; }

  /* flipbook pages container */
  .flipbook {
    width:300px; max-width:100%;
    height:220px; margin:auto; position:relative;
    perspective:1200px;
  }
  .page {
    position:absolute; inset:0; border-radius:12px;
    background:linear-gradient(180deg,#fff,#fffefc);
    box-shadow: 0 12px 30px rgba(0,0,0,0.06);
    transition: transform .7s cubic-bezier(.2,.9,.2,1), opacity .35s;
    display:flex; flex-direction:column; gap:10px; padding:12px;
    overflow:hidden;
  }
  .page.page-1 { transform-origin:left center; z-index:40; }
  .page.page-2 { transform-origin:left center; z-index:30; left:6px; top:6px; width:calc(100% - 6px); }
  .page.page-3 { transform-origin:left center; z-index:20; left:12px; top:12px; width:calc(100% - 12px); opacity:0.95; }

  .page.flipped { transform: rotateY(-150deg) translateX(-60px); opacity:0; }

  /* center: room & window */
  .room {
    position:relative;
    display:flex; gap:18px; flex-direction:column;
  }

  .window {
    background: radial-gradient(ellipse at 50% 40%, rgba(255,245,250,0.8), rgba(255,235,245,0.6) 40%, rgba(255,220,235,0.6));
    border-radius: 18px; padding:18px;
    box-shadow: inset 0 10px 40px rgba(255,230,240,0.35), 0 18px 44px rgba(255,150,185,0.08);
    position:relative; overflow:visible;
  }

  /* nighttime canvas inside window */
  .sky {
    width:100%; min-height:320px; border-radius:12px; background: radial-gradient(ellipse at 50% 20%, #fff8fb 0%, #ffeef6 5%, #ffd8ec 35%, #ffd9f4 100%);
    display:flex; align-items:center; justify-content:center; position:relative;
  }

  /* star / constellation */
  .star { position:absolute; width:6px; height:6px; background:white; border-radius:50%; box-shadow: 0 0 8px rgba(255,240,250,0.9); opacity:0.9; }
  .node {
    position:absolute; width:48px; height:48px; border-radius:999px; display:flex; align-items:center; justify-content:center;
    background: linear-gradient(180deg, #fff, #ffe6f0);
    box-shadow: 0 8px 20px rgba(255,140,185,0.18);
    cursor:pointer; user-select:none;
    transition: transform .36s ease, box-shadow .36s ease;
  }
  .node:hover { transform: translateY(-4px) scale(1.03); box-shadow: 0 18px 44px rgba(255,140,185,0.22); }
  .node .label{ font-size:0.86rem; color:var(--deep); font-weight:700; }

  /* orbit animations (CSS keyframes but JS sets positions) */
  .orbit-wrap{ position:absolute; left:50%; top:50%; transform:translate(-50%,-50%); width:480px; height:480px; pointer-events:none; }

  /* breathing circle sitting at center (on top of orbit) */
  .breath {
    position:absolute; left:50%; top:50%; transform:translate(-50%,-50%);
    width:220px; height:220px; border-radius:999px;
    background: radial-gradient(circle at 40% 30%, #fff, #ffeef6 40%, #ffddec 100%);
    box-shadow: inset 0 6px 18px rgba(255,255,255,0.7), 0 18px 44px rgba(255,150,185,0.12);
    display:flex; align-items:center; justify-content:center; transition: transform 7000ms cubic-bezier(.2,.9,.2,1);
    will-change: transform;
    overflow:visible;
  }
  .breath.small{ transform: scale(0.78); }
  .breath.big{ transform: scale(1.18); }
  .breath.contract{ transform: scale(0.78); transition-duration:4000ms; }

  .paw-center { width:110px; height:110px; pointer-events:none; display:block; }
  .paw-center img{ width:100%; height:100%; object-fit:contain; display:block; filter: drop-shadow(0 14px 24px rgba(0,0,0,0.06)); }

  /* floating paw prints */
  .float-paw { position:absolute; font-size:18px; transform: translateY(0) scale(.8); opacity:1; transition: transform 1200ms ease-out, opacity 1200ms ease-out; pointer-events:none; }

  /* Affirmation box */
  .affirm {
    background: linear-gradient(90deg,#fff6fb,#fff0f6);
    padding:12px; border-radius:12px; border:1px solid rgba(255,220,230,0.6);
    text-align:center; color:var(--muted); font-weight:600;
  }

  /* responsive tuning */
  @media(max-width:640px){
    .orbit-wrap{ width:320px; height:320px; }
    .breath{ width:170px; height:170px; }
    .paw-center{ width:84px; height:84px; }
    .book { width:120px; height:84px; }
    .flipbook { width:260px; height:200px; }
  }
</style>
</head>
<body>

<div class="stage">

  <!-- LEFT COLUMN: room shelf + flipbook + small controls -->
  <div class="left">

    <div class="panel">
      <header><h1>üêæ Cozy Room</h1></header>
      <p class="sub mt-2">Click items in the room ‚Äî shelf radio, the little book, or window stars.</p>
    </div>

    <!-- room illustration simplified with hotspots -->
    <div class="panel">
      <div style="display:flex;flex-direction:column;align-items:center;gap:10px;">
        <!-- stylized shelf & book -->
        <div style="width:100%;display:flex;justify-content:center;align-items:center;">
          <div class="book" id="bookToggle" role="button" aria-pressed="false" title="Open Dreambook">
            <div class="book-label">Dreambook</div>
          </div>
        </div>

        <!-- flipbook pages (hidden until book open) -->
        <div class="flipbook mt-3" id="flipbook">
          <div class="page page-3" id="page3">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div style="font-weight:700">Surprises</div>
              <div style="font-size:0.9rem;color:var(--muted)">Swipe</div>
            </div>
            <div style="flex:1; display:flex; align-items:center; justify-content:center; font-size:0.95rem; color:var(--muted)">
              A little surprise waits here ‚ú®
            </div>
          </div>

          <div class="page page-2" id="page2">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div style="font-weight:700">Affirmations</div>
              <div style="font-size:0.9rem;color:var(--muted)">Auto</div>
            </div>
            <div style="flex:1; display:flex; align-items:center; justify-content:center;">
              <div class="affirm" id="flipAff">You are loved and cherished üå∏</div>
            </div>
          </div>

          <div class="page page-1" id="page1">
            <div style="display:flex;justify-content:space-between;align-items:center;">
              <div style="font-weight:700">Playlist</div>
              <div style="font-size:0.9rem;color:var(--muted)">Play</div>
            </div>
            <div style="margin-top:8px;">
              <iframe id="miniSpotify" style="width:100%; height:78px; border-radius:10px; border:none;" src="https://open.spotify.com/embed/playlist/37i9dQZF1DWU0ScTcjJBdj" allow="autoplay; clipboard-write; encrypted-media; fullscreen; picture-in-picture"></iframe>
            </div>
          </div>
        </div>

      </div>
    </div>

    <div class="panel">
      <div style="display:flex;flex-direction:column;gap:8px;">
        <div style="display:flex;gap:8px;align-items:center;justify-content:center;">
          <button class="pill" onclick="openPlaylist()" style="background:linear-gradient(90deg,var(--accent1),var(--accent2)); color:white; padding:10px 14px; border-radius:999px; font-weight:700; box-shadow:0 10px 28px rgba(255,120,170,0.12)">Open Full Playlist</button>
        </div>
        <div style="text-align:center;" class="sub">Or tap the stars in the window to bring up features.</div>
      </div>
    </div>

  </div>

  <!-- RIGHT: main Room + window stage -->
  <div class="room">

    <!-- window card -->
    <div class="panel window">
      <div class="sky" id="sky">

        <!-- orbit wrap (nodes) -->
        <div class="orbit-wrap" id="orbitWrap">
          <!-- nodes generated by JS -->
        </div>

        <!-- breathing circle (center) -->
        <div class="breath small" id="breath">
          <div class="paw-center" id="pawCenter">
            <img src="paw.png" alt="paw" onerror="console.warn('paw.png missing ‚Äî place paw.png next to this file')"/>
          </div>
        </div>

        <!-- anim layer for paw floaters & sparkles -->
        <div id="animLayer" style="position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;"></div>

      </div>

      <!-- controls beneath the window -->
      <div style="display:flex;gap:12px;justify-content:center;margin-top:16px;">
        <button id="btnBreathe" style="background:linear-gradient(90deg,var(--accent1),var(--accent2)); color:white; padding:10px 18px; border-radius:999px; font-weight:700; box-shadow:0 10px 28px rgba(255,120,170,0.12)">Start Breathing</button>
        <button id="btnGuide" style="background:white;border:1px solid rgba(255,200,220,0.7); padding:9px 14px; border-radius:999px; color:var(--accent2); font-weight:700">How to</button>
      </div>

    </div>

    <!-- affirmation footer / small notes -->
    <div style="display:flex;justify-content:center;">
      <div class="panel" style="width:100%; max-width:720px; display:flex;flex-direction:column;align-items:center;">
        <div style="width:100%;"><h3 style="margin:0;font-size:1.05rem;">üí¨ Gentle Affirmion</h3></div>
        <div style="margin-top:10px; width:100%;"><div class="affirm" id="mainAff">Every breath you take brings peace üå¨</div></div>
        <div style="margin-top:8px;color:var(--muted);font-size:0.85rem;">(changes every 5s)</div>
      </div>
    </div>

  </div>
</div>

<script>
/* -------------------------
  Utility & small helpers
   ------------------------- */
function openPlaylist(){
  window.open('https://open.spotify.com/playlist/37i9dQZF1DWU0ScTcjJBdj','_blank');
}

/* -------------------------
  Flipbook behavior
   ------------------------- */
const bookToggle = document.getElementById('bookToggle');
const page1 = document.getElementById('page1');
const page2 = document.getElementById('page2');
const page3 = document.getElementById('page3');
let bookOpen = false;
bookToggle.addEventListener('click', () => {
  bookOpen = !bookOpen;
  bookToggle.classList.toggle('open', bookOpen);
  // when open show pages by removing flipped class
  if (bookOpen) {
    page1.classList.remove('flipped');
    page2.classList.remove('flipped');
    page3.classList.remove('flipped');
    // brief nudges
    setTimeout(()=> page1.classList.add('flipped'), 1600);
    setTimeout(()=> page2.classList.add('flipped'), 2400);
    setTimeout(()=> page3.classList.add('flipped'), 3000);
  } else {
    // close -> reset
    page1.classList.remove('flipped');
    page2.classList.remove('flipped');
    page3.classList.remove('flipped');
  }
});

/* -------------------------
  Affirmations rotation (two places)
   ------------------------- */
const mainAff = document.getElementById('mainAff');
const flipAff = document.getElementById('flipAff');
const affirmations = [
  "Every breath you take brings peace üå¨",
  "You are doing amazing, Divanshi üíõ",
  "You are loved and cherished üå∏",
  "You make tiny moments feel like magic ‚ú®",
  "You are exactly where you need to be üíó"
];
let aIdx = 0;
function rotateAff() {
  aIdx = (aIdx + 1) % affirmations.length;
  // cross-fade main
  mainAff.classList.remove('aff-in'); mainAff.classList.add('aff-out');
  setTimeout(()=> {
    mainAff.textContent = affirmations[aIdx];
    mainAff.classList.remove('aff-out'); mainAff.classList.add('aff-in');
  }, 380);
  // also update flipbook mini
  flipAff.textContent = affirmations[(aIdx+2) % affirmations.length];
}
let affInterval = setInterval(rotateAff, 5000);

/* -------------------------
  Constellation nodes (orbiting + hotspots)
   ------------------------- */
const orbitWrap = document.getElementById('orbitWrap');
const nodesData = [
  {id:'n-play', label:'Play', angle: -30, r:140},
  {id:'n-breathe', label:'Breathe', angle: 70, r:160},
  {id:'n-affirm', label:'Affirm', angle: 170, r:140},
  {id:'n-surprise', label:'Surprise', angle: 270, r:160}
];
// create nodes
nodesData.forEach(d => {
  const n = document.createElement('div');
  n.className = 'node';
  n.id = d.id;
  n.style.left = '50%'; n.style.top = '50%';
  n.style.width = '56px'; n.style.height='56px';
  n.style.pointerEvents = 'auto';
  n.innerHTML = `<div class="label">${d.label}</div>`;
  orbitWrap.appendChild(n);
  // attach click handlers
  n.addEventListener('click', ()=> {
    focusNode(d.id);
  });
});

// orbit motion (simple JS-driven circular motion for soft orbit effect)
let orbitAngle = 0;
function updateOrbit(ts){
  orbitAngle += 0.0006 * (ts||16); // slow rotation
  nodesData.forEach((d,i)=>{
    const node = document.getElementById(d.id);
    const base = d.angle * Math.PI/180;
    const a = base + orbitAngle + (i*0.08);
    const r = (d.r || 140);
    const cx = orbitWrap.clientWidth/2, cy = orbitWrap.clientHeight/2;
    const x = cx + Math.cos(a) * r;
    const y = cy + Math.sin(a) * r;
    node.style.left = x + 'px';
    node.style.top = y + 'px';
  });
  requestAnimationFrame(updateOrbit);
}
requestAnimationFrame(updateOrbit);

/* focus node: small micro-interaction */
function focusNode(id){
  // highlight selected node quickly
  const n = document.getElementById(id);
  const original = n.style.transform;
  n.style.transform = 'scale(1.12) translateY(-6px)';
  setTimeout(()=> n.style.transform = original, 700);

  if (id === 'n-play') openPlaylist();
  if (id === 'n-breathe') {
    // scroll to window and start breathing
    document.getElementById('breath').scrollIntoView({behavior:'smooth', block:'center'});
    setTimeout(()=> startBreathing(), 700);
  }
  if (id === 'n-affirm') {
    rotateAff(); // show next affirmation
  }
  if (id === 'n-surprise') {
    // open book and flash surprise page
    if (!bookToggle.classList.contains('open')) bookToggle.click();
    // reveal surprise page (simulate)
    page3.style.transform = 'translateY(6px)';
    setTimeout(()=> page3.style.transform='', 1200);
  }
}

/* -------------------------
  Breathing ritual (7s inhale, 8s hold, 4s exhale)
   ------------------------- */
const breathEl = document.getElementById('breath');
const btnBreathe = document.getElementById('btnBreathe');
const animLayer = document.getElementById('animLayer');

const inhaleMs = 7000, holdMs = 8000, exhaleMs = 4000;
let breathing = false, breathTimer = null;

function spawnFloatPaws(){
  // spawn 6 small paw emojis floating upward
  for(let i=0;i<6;i++){
    const el = document.createElement('div');
    el.className = 'float-paw';
    el.textContent = 'üêæ';
    const left = (50 + (Math.random()-0.5)*28);
    const top = (50 + (Math.random()-0.5)*28);
    el.style.left = left + '%';
    el.style.top = top + '%';
    el.style.opacity = '1';
    el.style.transform = 'translateY(0) scale(.9)';
    animLayer.appendChild(el);
    requestAnimationFrame(()=> {
      const dx = (-80 + Math.random()*160);
      const dy = -(90 + Math.random()*60);
      el.style.transform = `translate(${dx}px, ${dy}px) scale(1)`;
      el.style.opacity = '0';
    });
    setTimeout(()=> el.remove(), 1500 + Math.random()*400);
  }
}

async function breatheCycle(){
  if (!breathing) return;
  // inhale -> expand
  breathEl.style.transition = `transform ${inhaleMs}ms cubic-bezier(.2,.9,.2,1)`;
  breathEl.classList.add('big'); breathEl.classList.remove('small','contract');
  await new Promise(res => breathTimer = setTimeout(res, inhaleMs));
  if (!breathing) return;
  // hold -> no change
  await new Promise(res => breathTimer = setTimeout(res, holdMs));
  if (!breathing) return;
  // exhale -> contract and spawn paws
  breathEl.style.transition = `transform ${exhaleMs}ms cubic-bezier(.2,.9,.2,1)`;
  breathEl.classList.add('contract'); breathEl.classList.remove('big','small');
  spawnFloatPaws();
  await new Promise(res => breathTimer = setTimeout(res, exhaleMs));
  if (!breathing) return;
  breathEl.classList.remove('contract'); breathEl.classList.add('small');
  await new Promise(res => breathTimer = setTimeout(res, 300));
  if (!breathing) return;
  breatheCycle();
}

function startBreathing(){
  if (breathing) return;
  breathing = true;
  btnBreathe.textContent = 'Stop Breathing';
  breatheCycle();
}
function stopBreathing(){
  breathing = false;
  btnBreathe.textContent = 'Start Breathing';
  clearTimeout(breathTimer);
  breathEl.classList.remove('big','contract'); breathEl.classList.add('small');
}

btnBreathe.addEventListener('click', ()=> {
  if (!breathing) startBreathing(); else stopBreathing();
});
document.getElementById('btnGuide').addEventListener('click', ()=> {
  alert('Breathe slowly:\nInhale ‚Äî 7 seconds\nHold ‚Äî 8 seconds\nExhale ‚Äî 4 seconds\nRepeat gently.');
});

/* Safety: stop breathing loop on page hide */
document.addEventListener('visibilitychange', ()=> {
  if (document.hidden) { breathing=false; clearTimeout(breathTimer); }
});

/* -------------------------
  small polish: initial states
   ------------------------- */
window.addEventListener('load', ()=> {
  // set small resting
  breathEl.classList.add('small');
  // hide flipbook pages until book is clicked
  page1.classList.add('flipped'); page2.classList.add('flipped'); page3.classList.add('flipped');
});

</script>
</body>
</html>
